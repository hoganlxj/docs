---
title: "机器人管理"
weight: 5
description: 机器人用来接收监控和预算告警消息。
---

机器人用来接收监控和预算告警消息。目前支持钉钉机器人、飞书机器人、企业机器人以及Webhook。其中Webhook用于将平台上资源的增删改查消息发送给特定的URL。

**入口**：在云管平台单击左上角![](../../../images/intro/nav.png)导航菜单，在弹出的左侧菜单栏中单击 **_"系统配置/消息中心/机器人管理"_** 菜单项，进入机器人管理页面。

![](../../../images/system/bot.png)

## 新建机器人

该功能用于添加机器人。

1. 在机器人管理页面，单击列表上方 **_"新建"_** 按钮，弹出新建机器人对话框。
2. 配置以下信息：
    - 指定项目：指定机器人的所属项目。
    - 名称：设置机器人的名称。
    - 类型：支持钉钉机器人、飞书机器人、企业机器人以及Webhook。
    - Webhook：配置对应的机器人的Webhook地址，不同类型的机器人的Webhook获取方式请参考[Webhook获取方式](#Webhook获取方式)。
3. 单击 **_"确定"_** 按钮，完成操作。

## Webhook获取方式

### 钉钉机器人

1. 在钉钉电脑客户端创建钉钉群或选择已有的钉钉群。
2. 钉钉群右上角群设置-智能群助手中添加自定义机器人。
3. 设置机器人名称，添加到对应群组以及在安全设置中勾选IP地址(段)，将{{<oem_name>}}平台的外网访问IP添加到IP地址段中。
4. 添加成功后获取机器人Webhook地址。

### 飞书机器人

1. 在飞书电脑客户端创建飞书群或选择已有的飞书群。
2. 飞书群右侧设置-群机器人添加Custom Bot机器人。
3. 添加成功后获取机器人Webhook地址。

### 企业微信机器人

1. 在企业微信客户端中创建企业微信群或选择已有的企业微信群。
2. 企业微信群右上角群设置-智能群助手添加自定义机器人。
3. 添加成功后获取机器人Webhook地址。

### Webhook机器人

1. 除上述三种机器人外，其它类型机器人也可以通过Webhook方式接入。
2. 在对应平台获取以下参数：
   - URL：机器人的Webhook地址。
   - header：机器人的Webhook额外的请求头。
   - body：机器人的Webhook额外的请求体。
   - msg_key：机器人的Webhook消息键。

## 修改机器人

该功能用于修改机器人信息。

1. 在机器人管理页面，单击机器人右侧操作列 **_"修改"_** 按钮，弹出修改机器人对话框。
2. 仅支持修改名称、Webhook。
3. 修改完成后，单击 **_"确定"_** 按钮，完成操作。

## 设置共享

该功能用于设置机器人的共享状态。

项目资源的共享范围有五种：

- 不共享（私有）：即项目资源只能本项目的用户可以使用。
- 项目共享-部分（本域内多项目共享）：即项目资源可以共享到同域下的指定项目（一个或多个），只有本项目和被共享项目下的用户可以使用项目资源。
- 项目共享-全部（本域共享）：即项目资源可以共享给域下所有项目，即项目所在域的用户都可以使用项目资源。
- 域共享-部分（多域共享）：即项目资源可以共享到指定域（一个或多个），只有项目资源所在域和共享域下的用户可以使用项目资源。
- 域共享-全部（全局共享）：即项目资源可以共享给全部域使用，即系统中所有用户都可以使用项目资源。

{{% alert title="说明" %}}
设置域共享的条件：

- 在{{<oem_name>}}平台已开启三级权限。
- 用户处于管理后台。

设置项目共享的条件：

- 用户处于管理后台或域管理后台。

{{% /alert %}}

{{% alert title="注意" color="warning" %}}
- 物理机、PXE、IPMI类型的机器人建议不要设置为共享状态。
- 本地IDC的机器人共享范围任意。
- 私有云和公有云的机器人的共享范围与云账号的共享范围有关。
    - 当云账号不共享时，通过云账号同步下来的资源也不能共享。
    - 当云账号启用共享时，通过云账号同步下来的资源也将随着云账号启用共享。
    - 当云账号启用共享时，通过云账号同步下来的资源可以更改共享范围，请确保共享范围在云账号的共享范围内。
    - 当云账号修改共享范围时，通过云账号同步下来的资源的共享范围要始终保持在云账号的共享范围内。如云账号共享A、B、C、D域，域资源共享A、C域，云账号修改共享范围为A、B域，则域资源只能共享到A域。
    - 云账号共享云订阅时，通过云账号同步下来的域资源不能共享。
{{% /alert %}}


**单个机器人设置共享**

1. 在机器人管理页面，单击机器人右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
2. 配置以下参数。
   - 当共享范围选择为“不共享”时，即项目资源的共享范围为私有，仅本项目的用户可以使用。
   - 当共享范围选择为“项目共享”时，需要选择本域下可共享的项目。
       - 当项目选择同域下的一个或多个项目时，即项目资源的共享范围为项目共享-部分，只有项目资源所在项目和共享项目下的用户可以使用项目资源。
       - 当项目选择全部时，即项目资源的共享范围为项目共享-全部，项目所在域下的用户都可以使用项目资源。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即项目资源的共享范围为域共享-部分，只有项目资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即项目资源的共享范围为域共享-全部，系统中的所有用户都可以使用项目资源。
3. 单击 **_"确定"_** 按钮，完成操作。

**批量设置共享**

多个机器人批量设置的共享范围必须相同。否则请单独为机器人设置共享。

1. 在机器人列表中选择一个或多个机器人，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
2. 配置以下参数。
   - 当共享范围选择为“不共享”时，即项目资源的共享范围为私有，仅本项目的用户可以使用。
   - 当共享范围选择为“项目共享”时，需要选择本域下可共享的项目。
       - 当项目选择同域下的一个或多个项目时，即项目资源的共享范围为项目共享-部分，只有项目资源所在项目和共享项目下的用户可以使用项目资源。
       - 当项目选择全部时，即项目资源的共享范围为项目共享-全部，项目所在域下的用户都可以使用项目资源。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即项目资源的共享范围为域共享-部分，只有项目资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即项目资源的共享范围为域共享-全部，系统中的所有用户都可以使用项目资源。
3. 单击 **_"确定"_** 按钮，完成操作。

## 更改项目

该功能用于更改机器人所属项目。当机器人为私有状态时，才可以更改项目。

**单个机器人更改项目**

1. 在机器人管理页面，单击机器人右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"更改项目"_** 菜单项，弹出更改项目对话框。
2. 修改域和项目，单击 **_"确定"_** 按钮。

**批量更改项目**

1. 在机器人列表中选择一个或多个机器人，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"更改项目"_** 菜单项，弹出更改项目对话框。
2. 修改域和项目，单击 **_"确定"_** 按钮。

## 启用

该功能用于启用"禁用"状态的机器人，禁用状态的机器人不会接收告警消息。

**单个启用**

1. 在机器人管理页面，单击"禁用"状态的机器人右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"启用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，启用机器人。

**批量启用**

1. 在机器人列表中选择一条或多条机器人，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"启用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，启用机器人。

## 禁用

该功能用于禁用"启用"状态的机器人，禁用状态的机器人不会接收告警消息。

**单个禁用**

1. 在机器人管理页面，单击"启用"状态的机器人右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"禁用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，禁用机器人。

**批量禁用**

1. 在机器人列表中选择一条或多条机器人，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"禁用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，禁用机器人。

## 删除

该功能用于删除机器人。

**单个删除**

1. 在机器人管理页面，单击机器人右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

**批量删除**

1. 在机器人列表中选择一条或多个机器人，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

## 查看机器人详情

该功能用于查看机器人的详细信息。

1. 在机器人管理页面，单击机器人名称项，进入机器人详情页面。
2. 查看机器人云上ID、ID、名称、状态、域、项目、共享范围、启用状态、类型、Webhook/URL、创建时间、更新时间、备注等。

## 查看操作日志

该功能用于查看机器人相关操作的日志信息。

1. 在机器人管理页面，单击机器人名称项，进入机器人详情页面。
2. 单击“操作日志”页签，进入操作日志页面。
    - 加载更多日志：列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 **_"加载更多"_** 按钮，获取更多日志信息。
    - 查看日志详情：单击操作日志右侧操作列 **_"查看"_** 按钮，查看日志的详情信息。支持复制详情内容。
    - 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。
    - 导出日志：目前仅支持导出本页显示的日志。单击右上角![](../../../images/system/download.png)图标，在弹出的导出数据对话框中，设置导出数据列，单击 **_"确定"_** 按钮，导出日志。