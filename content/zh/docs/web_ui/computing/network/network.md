---
title: "IP子网"
weight: 2
description: IP子网用于为虚拟机、宿主机等资源提供IP地址。
---

IP子网用于为虚拟机、宿主机等资源提供IP地址。

- 经典网络下，IP子网之间的IP地址范围不能重合。
- VPC网络下，不同VPC下的IP子网地址范围可以重合。

**IP子网来源**：

- 在云管平台新增IP子网，新建虚拟机类型的IP子网共享范围默认全局共享，新建其他类型的IP子网共享范围默认不共享。
- 同步公有云或私有云环境中的IP子网，同步的IP子网共享范围默认本域共享。

{{% alert title="注意" color="warning" %}}
在{{<oem_name>}}平台添加Azure云账号后，将会同步Azure平台的VPC网络和经典网络的IP子网到{{<oem_name>}}平台，但是在{{<oem_name>}}平台只支持创建使用VPC网络的Azure虚拟机，所以同步到{{<oem_name>}}平台的Azure经典网络的IP子网将在{{<oem_name>}}平台上显示为不可用。
{{% /alert %}}
    
**入口**：在云管平台单击左上角![](../../../images/intro/nav.png)导航菜单，在弹出的左侧菜单栏中单击 **_"主机/网络/IP子网"_** 菜单项，进入IP子网页面。

  ![](../../../images/computing/ipsubnet.png)


## 新建IP子网

该功能用于创建IP子网。

{{% alert title="说明" %}}
在新建IP子网页面，可单击顶部“本地IDC”、“私有云”、“公有云”页签，切换创建不同平台上的IP子网。
{{% /alert %}}

### 新建本地IDC的IP子网

本地IDC的IP子网分为经典网络（即：VPC为default）的IP子网和VPC网络（即：VPC为非default）的IP子网。其中经典网络的IP子网支持设置VLAN，一个VLAN也是一个广播域，属于同一VLAN的IP子网之间可以直接通信，属于不同VLAN的IP子网不可以直接通信，需要通过三层设备进行通信等。

1. 在IP子网页面，单击顶部“全部”或“本地IDC”页签，单击列表上方 **_"新建"_** 按钮，进入新建本地IDC的IP子网页面。
2. 设置以下信息：
    - 指定项目：选择IP子网的所属项目。
    - 区域：选择IP子网所属区域。
    - 名称：设置IP子网的名称。
    - VPC：选择IP子网所属VPC。
        - 当VPC选择为“default（经典网络）”时：
            - 二层网络：选择区域、专有网络以及二层网络。
            - 服务器类型：设置IP子网用于为哪类服务器分配IP地址，包括虚拟机（虚拟机和裸金属）、物理机（物理机和宿主机）、PXE、IPMI、弹性公网IP。
            - 子网网段：设置起始IP地址、结束IP地址、子网掩码、默认网关（选填）、VLAN ID（选填）等。支持一次性增加6个IP子网段，当一次性创建多个IP子网时，子网名称由系统自动分配，如创建3个IP子网，页面中IP子网名称设置为network，则名称依次为network0、network1、network2。
            - 自动调度：仅当服务器类型为虚拟机时，支持设置自动调度，启用自动调度后，用户创建虚拟机网络指定自动调度时，将从启用自动调度的IP子网中为虚拟机分配IP地址。
            - 高级配置：单击“高级配置”超连接，展开高级配置选项。
                - 线路类型：当服务器类型为弹性公网IP时，支持自定义标记EIP的线路类型，例如，联通、移动等；在【费用-费率配置】中支持针对不同线路类型的EIP设置不同的费率，若无线路类型，则使用默认EIP费率。
                - 地址分配策略：包括缺省策略（物理机从IP子网高地址开始分配，虚拟机从IP子网低地址开始分配）、从高地址分配、从低地址分配、随机分配。
                - 域名服务器：设置域名服务器。
                - 主机域名后缀：当设置主机域名后缀时，当系统为主机分配一个IP，同时也会创建一条指向该IP的域名记录，域名格式由主机名称+主机域名后缀组成。例如主机名称为VM01，分配IP地址为192.168.1.1，主机域名后缀为test.com。即创建一条192.168.1.1与VM01.test.com对应的域名记录，当使用ping命令，ping VM01.test.com，将返回192.168.1.1的IP地址。
        - 当VPC选择“vpc名称（网段）”时：
            - 可用区：选择IP子网所属的可用区，一个VPC下可以有多个可用区的IP子网，同一VPC下不同可用区的子网默认互通。
            - 子网网段：设置子网的IP地址范围，IP子网需要在VPC的网段范围内。支持最多增加5个子网。
            - 自动调度：启用自动调度后，用户创建虚拟机网络指定自动调度时，将从启用自动调度的IP子网中为虚拟机分配IP地址。
    
3. 单击 **_"确定"_** 按钮，完成创建。

### 新建私有云的IP子网

1. 在IP子网页面，单击顶部“私有云”页签，单击列表上方 **_"新建"_** 按钮，进入新建私有云的IP子网页面。
2. 设置以下信息：
    - 指定项目：选择IP子网的所属项目。
    - 区域：选择IP子网所属区域。
        - 当区域选择为“OpenStack”的区域时：
            - VPC：选择OpenStack平台上的VPC。
            - 可用区：设置IP子网所属的可用区。一个VPC下可以有多个可用区的IP子网，同一VPC下不同可用区的子网默认互通。
        - 当区域选择为”ZStack/DStack“的区域
            - VPC：选择ZStack/DStack平台上的二层网络。
            - 二层网络：设置IP子网所属的二层网络。
    - 名称：设置IP子网的名称。
    - 子网网段：设置IP地址范围段，格式如192.168.0.0/24，IP子网需要在VPC的网段范围内。
    - 自动调度：启用后，用户创建虚拟机网络指定自动分配时，将从启用自动调度的IP子网中为虚拟机分配IP地址。
3. 单击 **_"确定"_** 按钮，完成创建。
   
### 新建公有云的IP子网

1. 在IP子网页面，单击顶部“公有云”页签，单击列表上方 **_"新建"_** 按钮，进入新建公有云的IP子网页面。
2. 设置以下信息：
    - 指定项目：选择IP子网的所属项目。
    - 区域：选择IP子网所属区域。可通过城市、平台快速过滤筛选出合适区域。
    - 名称：设置IP子网的名称。
    - VPC：选择IP子网所属的VPC。
    - 可用区：设置IP子网所属的可用区。一个VPC下可以有多个可用区的IP子网，同一VPC下不同可用区的子网默认互通。
    - 子网网段：设置IP地址范围段，格式如192.168.0.0/24，IP子网需要在VPC的网段范围内。
    - 自动调度：启用自动调度后，用户创建虚拟机网络指定自动调度时，将从启用自动调度的IP子网中为虚拟机分配IP地址。    
3. 单击 **_"确定"_** 按钮，完成创建。
  
## 调整调度标签

该功能用于为IP子网绑定调度标签，绑定调度标签的IP子网将遵循调度策略为虚拟机分配IP地址。

1. 单击IP子网右侧操作列 **_"调整调度标签"_** 按钮，弹出调整调度标签对话框。
2. 选择调度标签，单击 **_"确定"_** 按钮。

## 修改属性

该功能用于修改IP子网。仅{{<oem_name>}}平台上的IP子网支持修改。

1. 单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"修改属性"_** 菜单项，进入IP子网页面。
2. 支持修改项如下：子网名称、服务器类型、起始IP、结束IP、子网掩码、默认网关、VLAN ID、高级配置(线路类型（仅弹性公网IP类型支持）、地址分配策略、域名服务器、主机域名后缀)。
3. 单击 **_"确定"_** 按钮。

## 更改项目

该功能用于更改IP子网所属项目。当IP子网为私有状态时，项目中的IP子网只支持为项目中的虚拟机分配IP。

**单个IP子网更改项目**

1. 在IP子网页面，单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"更改项目"_** 菜单项，弹出更改项目对话框。
2. 修改域和项目，单击 **_"确定"_** 按钮。

**批量更改项目**

1. 在IP子网列表中选择一个或多个IP子网，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"更改项目"_** 菜单项，弹出更改项目对话框。
2. 修改域和项目，单击 **_"确定"_** 按钮。

## 设置共享

该功能用于设置IP子网的共享状态。

项目资源的共享范围有五种：

- 不共享（私有）：即项目资源只能本项目的用户可以使用。
- 项目共享-部分（本域内多项目共享）：即项目资源可以共享到同域下的指定项目（一个或多个），只有本项目和被共享项目下的用户可以使用项目资源。
- 项目共享-全部（本域共享）：即项目资源可以共享给域下所有项目，即项目所在域的用户都可以使用项目资源。
- 域共享-部分（多域共享）：即项目资源可以共享到指定域（一个或多个），只有项目资源所在域和共享域下的用户可以使用项目资源。
- 域共享-全部（全局共享）：即项目资源可以共享给全部域使用，即系统中所有用户都可以使用项目资源。

{{% alert title="说明" %}}
设置域共享的条件：

- 在{{<oem_name>}}平台已开启三级权限。
- 用户处于管理后台。

设置项目共享的条件：

- 用户处于管理后台或域管理后台。

{{% /alert %}}

{{% alert title="注意" color="warning" %}}
- 物理机、PXE、IPMI类型的IP子网建议不要设置为共享状态。
- 本地IDC的IP子网共享范围任意。
- 私有云和公有云的IP子网的共享范围与云账号的共享范围有关。
    - 当云账号不共享时，通过云账号同步下来的资源也不能共享。
    - 当云账号启用共享时，通过云账号同步下来的资源也将随着云账号启用共享。
    - 当云账号启用共享时，通过云账号同步下来的资源可以更改共享范围，请确保共享范围在云账号的共享范围内。
    - 当云账号修改共享范围时，通过云账号同步下来的资源的共享范围要始终保持在云账号的共享范围内。如云账号共享A、B、C、D域，域资源共享A、C域，云账号修改共享范围为A、B域，则域资源只能共享到A域。
    - 云账号共享云订阅时，通过云账号同步下来的域资源不能共享。
{{% /alert %}}


**单个IP子网设置共享**

1. 在IP子网页面，单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
2. 配置以下参数。
   - 当共享范围选择为“不共享”时，即项目资源的共享范围为私有，仅本项目的用户可以使用。
   - 当共享范围选择为“项目共享”时，需要选择本域下可共享的项目。
       - 当项目选择同域下的一个或多个项目时，即项目资源的共享范围为项目共享-部分，只有项目资源所在项目和共享项目下的用户可以使用项目资源。
       - 当项目选择全部时，即项目资源的共享范围为项目共享-全部，项目所在域下的用户都可以使用项目资源。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即项目资源的共享范围为域共享-部分，只有项目资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即项目资源的共享范围为域共享-全部，系统中的所有用户都可以使用项目资源。
3. 单击 **_"确定"_** 按钮，完成操作。

**批量设置共享**

多个IP子网批量设置的共享范围必须相同。否则请单独为IP子网设置共享。

1. 在IP子网列表中选择一个或多个IP子网，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
2. 配置以下参数。
   - 当共享范围选择为“不共享”时，即项目资源的共享范围为私有，仅本项目的用户可以使用。
   - 当共享范围选择为“项目共享”时，需要选择本域下可共享的项目。
       - 当项目选择同域下的一个或多个项目时，即项目资源的共享范围为项目共享-部分，只有项目资源所在项目和共享项目下的用户可以使用项目资源。
       - 当项目选择全部时，即项目资源的共享范围为项目共享-全部，项目所在域下的用户都可以使用项目资源。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即项目资源的共享范围为域共享-部分，只有项目资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即项目资源的共享范围为域共享-全部，系统中的所有用户都可以使用项目资源。
3. 单击 **_"确定"_** 按钮，完成操作。

## 分割IP子网

该功能用于分割IP子网范围，将一个子网分成两个子网。仅{{<oem_name>}}平台支持。

1. 单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"分割IP子网"_** 菜单项，弹出分割IP子网对话框。
2. 输入新IP子网名称、新IP子网起始IP（原IP子网地址范围：原IP子网起始IP至新IP子网起始IP末位-1；新IP子网地址范围：新IP子网起始IP至原IP子网结束IP）。
3. 单击 **_"确定"_** 按钮。

## 合并IP子网

该功能用于将分割的IP子网，合并为一个IP子网，仅{{<oem_name>}}平台支持。

1. 在IP子网列表中选择两个IP地址段连续的IP子网，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"合并IP子网"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，将两个IP子网合并为一个，IP子网名称为IP地址大的IP子网名称。

## 预留IP

该功能用于预留IP子网中的IP，预留IP将不会被云管平台分配给服务器使用。

1. 单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"预留IP"_** 菜单项，弹出预留IP对话框。
2. 输入IP子网中的需要预留的IP地址(支持一次添加6个IP地址)、预留原因，单击 **_"确定"_** 按钮。

## 设置自动调度

该功能用于为IP子网启用或禁用自动调度功能，启用后，用户创建虚拟机时网络自动调度时，将从启用自动调度的IP子网中为虚拟机分配IP地址。

{{% alert title="注意" color="warning" %}}
仅虚拟机类型的IP子网支持设置自动调度。
{{% /alert %}}

**单个IP子网设置自动调度**

1. 单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"设置自动调度"_** 菜单项，弹出设置自动调度对话框。
2. 设置是否启用自动调度功能，设置完成后，单击 **_"确定"_** 按钮。

**批量设置自动调度**

1. 在IP子网列表中选择一个或多个IP子网，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置自动调度"_** 菜单项，弹出设置自动调度对话框。
2. 设置是否启用自动调度功能，设置完成后，单击 **_"确定"_** 按钮。

## 同步状态

该功能用于获取IP子网的当前状态。

**单个同步状态**

1. 单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"同步状态"_** 菜单项，同步IP子网状态。

**批量同步状态**

1. 在IP子网列表中选择一个或多个IP子网，单击IP子网右侧操作列 **_"批量操作"_** 按钮，选择下拉菜单 **_"同步状态"_** 菜单项，批量同步状态。

## 删除IP子网

该功能用于删除IP子网。已分配IP的IP子网不支持删除。

**单个删除**

1. 单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

**批量删除**

1. 在IP子网列表中选择一个或多个IP子网，单击IP子网右侧操作列 **_"批量操作"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

## 查看IP子网详情

该功能用于查看IP子网详细信息。

1. 在IP子网页面，单击IP子网名称项，进入IP子网详情页面。
2. 详情页面顶部菜单项支持对IP子网进行管理操作。
3. 查看以下信息。
    - 基本信息：包括云上ID、ID、名称、状态、域、项目、用户标签、共享范围、平台、调度标签、区域、可用区、云账号、云订阅、创建时间、更新时间、备注等。
    - 配置信息：包括VPC、二层网络、服务器类型、线路类型、IP范围、子网掩码、网关、VLAN ID、使用情况、域名服务器、主机域名后缀。

### 查看IP使用情况

该功能主要用于查看IP子网中分别用于宿主机、主机、预留IP、负载均衡IP以及弹性网卡IP等用途的IP信息。

1. 在IP子网详情页面，单击“IP使用情况”页签，进入IP使用情况页面。
2. 查看IP子网中用于各类用途的IP地址信息。

### 查看操作日志信息

该功能用于查看IP地址相关操作的日志信息。

1. 在IP子网详情页面，单击”操作日志“页签，进入操作日志页面。
    - 加载更多日志：列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 **_"加载更多"_** 按钮，获取更多日志信息。
    - 查看日志详情：单击操作日志右侧操作列 **_"查看"_** 按钮，查看日志的详情信息。支持复制详情内容。
    - 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。
    - 导出日志：目前仅支持导出本页显示的日志。单击右上角![](../../../images/system/download.png)图标，在弹出的导出数据对话框中，设置导出数据列，单击 **_"确定"_** 按钮，导出日志。



