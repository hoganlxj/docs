---
title: "主机模板"
weight: 4
description: 主机模板保存创建虚拟机的配置信息，用于后续快速创建虚拟机。
---

主机模板保存创建虚拟机的配置信息，用于后续快速创建虚拟机。

**入口**:在云管平台左侧菜单项中单击 **_"主机/主机/主机模板"_** 菜单项，进入主机模板页面。

![](../../../images/computing/servertemplate.png)

## 新建主机模板

该功能用于创建主机模板。创建主机模板配置参数与创建虚拟机配置参数大同小异。

### 新建主机模板前提条件

- 本地IDC：要求基础资源中存在启用状态的{{<oem_name>}}平台宿主机，或云管平台已对接VMware平台，基础资源中存在启用状态的VMware平台的宿主机。
- 私有云：要求云管平台已导入OpenStack、ZStack或DStack云账号的资源，基础资源中存在启用状态的属于上述平台的宿主机，且对应平台有可用IP子网。
- 公有云：要求云管平台已导入阿里云、AWS、Azure、华为云、腾讯云或UCloud云账号的资源，云账号已启用且状态正常，且对应平台有可用IP子网。

### 新建主机模板

1. 在主机模板页面，支持创建本地IDC主机模板、私有虚拟机模板以及公有虚拟机模板。
    - 本地IDC主机模板：单击列表上方 **_"新建"_** 按钮，选择下拉菜单 **_"IDC"_** 菜单项，进入创建本地IDC主机模板页面。
    - 私有虚拟机模板：单击列表上方 **_"新建"_** 按钮，选择下拉菜单 **_"私有云"_** 菜单项，进入创建私有虚拟机模板页面。
    - 公有虚拟机模板：单击列表上方 **_"新建"_** 按钮，选择下拉菜单 **_"公有云"_** 菜单项，进入创建公有虚拟机模板页面。
2. 配置以下参数：
    - 指定项目：选择主机模板的所属项目。
    - 模板名称：设置主机模板的名称。
    - 区域（本地IDC、私有云）：选择区域和可用区。创建私有云平台虚拟机时需要通过区域确定虚拟机所属的平台。
    - 计费方式（公有云）：包括按量付费、包年包月。
        - 按量付费：按虚拟机的实际使用量付费，此模式适用于设备需求量会瞬间大幅度增大的场景，价格对比包年包月要贵。
        - 包年包月：是一种预付费的模式，提前一次性支付一个月、一年乃至多年的费用，该模式适用于设备需求比较平稳的场景，价格相对按量付费更便宜。
    - 平台（本地IDC）：选择虚拟机所属的平台，包括{{<oem_name>}}和VMware。
    - 平台及区域（公有云）：可通过地域、平台、区域、可用区确定用户可选套餐，建议选择最靠近的地域，可以降低访问时延，提高访问速度。
{{% alert title="说明" %}}
当创建公有云平台的虚拟机选择地域后，可选平台和区域需要同时满足以下条件：

  - 有对应平台的云账号，且云账号未被禁用且余额充足；
  - 有对应平台区域的VPC和IP子网；
{{% /alert %}}
    - CPU架构：目前支持x86和arm架构。仅{{<oem_name>}}平台支持arm架构，其他平台默认只支持x86架构。
    - 是否配置GPU：是否为虚拟机配置GPU卡，启用该项后，还需要选择具体GPU卡。
    - CPU核数、内存：设置虚拟机的规格。并可以根据虚拟机规格等选择可用套餐。
    - 套餐：虚拟机套餐为虚拟机CPU、内存规格的组合搭配，不同套餐价格不同。其中本地IDC和私有云套餐可通过云管平台进行维护，用户创建私有云平台的虚拟机时可以选择本地IDC的套餐或私有云平台的套餐。公有云套餐信息同步对应公有云平台上信息。
    - 操作系统：
        - 公有云镜像：显示对应公有云平台上的公共镜像，仅公有云平台支持，不在镜像列表中显示。
        - 公有云自定义镜像：支持选择对应公有云平台指定云账号上的自定义镜像，仅公有云平台支持，不在镜像列表中显示。
        - 私有云镜像：显示对应私有云平台上的镜像，仅私有云平台支持。不在镜像列表中显示。
        - VMware平台镜像：支持选择VMware平台上指定VMware账户的镜像，仅VMware平台支持。不在镜像列表中显示。
        - 公共镜像：对应系统镜像列表中的公共镜像，一般为系统常用镜像，由管理员维护。
        - 自定义镜像：对应系统镜像列表中的自定义镜像，一般是由用户上传。
        - 从ISO启动：对应系统镜像列表中的ISO格式的镜像。选择ISO镜像文件时，需要用户为虚拟机安装操作系统。仅{{<oem_name>}}平台支持。
        - 主机镜像：对应主机镜像列表中的主机镜像，仅{{<oem_name>}}平台支持。
        - 主机快照：对应主机快照列表中的主机快照，仅{{<oem_name>}}平台支持。
{{% alert title="说明" %}}
当在公有云平台创建虚拟机时使用云管平台上的公共镜像和自定义镜像，由于需要向公有云平台缓存镜像，创建时间可能会较长，建议使用已缓存镜像。已缓存镜像在镜像名称右侧有已缓存标志。
{{% /alert %}}
    - 系统磁盘：根据选择的套餐情况显示并设置不同的磁盘类型以及磁盘的容量大小。公有云平台不支持设置调度标签。
{{% alert title="注意" color="warning" %}}
- 当在腾讯云平台创建虚拟机时，系统盘大小必须为10的倍数。否则会创建失败。
- 当操作系统选择”从ISO启动“时，虚拟机上的磁盘类型都显示为数据盘。磁盘类型显示不影响虚拟机的正常使用。
{{% /alert %}}
        - 当不设置调度标签及调度偏好时，系统将按照调度策略以及调度标签为虚拟机选择最优的存储。
            - 优先检查系统中的调度策略，当有符合的调度策略，将根据调度策略中设置的调度标签及调度标签偏好选择对应存储。调度策略中的调度标签偏好会覆盖调度标签中的默认策略。
            - 当没有符合的调度策略后，将根据存储设备中绑定的调度标签的默认策略选择最优存储。
        - 当设置调度标签和调度标签偏好时，设置的调度标签偏好将覆盖调度标签上的默认策略。根据调度偏好以及调度标签选择提供系统盘的存储。
            - 尽量使用（prefer）：调度时优先使用拥有这种标签的存储。
            - 避免使用（avoid）：调度时尽量避免拥有这种标签的存储。
            - 禁止使用（exclude）：调度时排除拥有这种标签的存储。
            - 必须使用（require）：调度时必须使用拥有这种标签的存储。
        - 举例说明：以本地存储为例，本地存储A绑定调度标签A，调度标签A默认策略为尽量使用。本地存储B绑定调度标签B，调度标签B默认策略为禁止使用。调度策略A为当在项目A中创建虚拟机时，选择调度标签B，调度策略偏好为必须使用。
            - 当不设置调度标签时，有以下两种情况。
                - 若虚拟机属于项目A，系统将优先选择本地存储B为虚拟机系统盘提供存储。
                - 当虚拟机不属于项目A，系统将优先选本地存储A为虚拟机系统盘提供存储。
            - 当设置调度标签为A，策略为禁止使用时，系统将会排除本地存储A，选择本地存储B为虚拟机系统盘提供存储。
   - 数据盘：可选项，可根据需求添加多块数据盘，最多支持12块数据盘。设置磁盘的类型及容量大小。磁盘可选类型同系统盘。
{{% alert title="注意" color="warning" %}}
添加的数据盘仅挂载到虚拟机上，不会自动执行分区操作，需要用户远程连接虚拟机后手动分区。
{{% /alert %}}
        - 仅{{<oem_name>}}平台支持支持设置挂载点、快照建磁盘、设置调度标签。私有云如使用本地存储，也支持设置调度标签功能。
            - 设置调度标签：同系统盘。
            - 设置挂载点：设置数据盘的文件类型（ext4、xfs、swap）、数据盘挂载的非系统目录。设置挂载点和快照建磁盘两者只能设置一个。
            - 快照建磁盘：根据快照创建数据盘。可在本地IDC中查看已存在的快照。设置挂载点和快照建磁盘两者只能设置一个。
    - 管理员密码：设置管理员密码，在Linux系统中为root用户的密码，在Windows操作系统中为administrator用户的密码。
        - 随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码
        - 关联密钥：在关联密钥之前需要先新建密钥。关联密钥后，用户需要使用私钥远程登录虚拟机。
        - 保留镜像设置：管理员密码为镜像中已有的管理员密码。
        - 手工输入：可手动设置管理员密码。
{{% alert title="说明" %}}
- 当选择从ISO启动时，不支持设置管理员密码，管理员密码需要在用户安装操作系统时进行设置。
- 根据虚拟机所在平台不同，设置管理员密码的方式可能为以上方式的其中几种，请以界面为准。
{{% /alert %}}
    - 网络：设置虚拟机的IP地址。仅{{<oem_name>}}平台虚拟机最多添加8个网络，其他平台仅支持一个网络。
        - 自动调度：当选择自动调度时，将从启用自动调度的IP子网中为虚拟机分配IP地址。
        - 指定IP子网：选择VPC和IP子网，如需指定静态IP，可单击 **_"手动配置IP"_** 按钮，设置IP地址，单击 **_"确定"_** 按钮。
        - 指定调度标签：设置调度标签以及调度标签偏好。设置的调度标签偏好将会覆盖调度标签上的默认策略。根据调度标签及调度偏好选择最优的IP子网。
            - 尽量使用（prefer）：调度时优先使用拥有这种标签的IP子网。
            - 避免使用（avoid）：调度时尽量避免拥有这种标签的IP子网。
            - 禁止使用（exclude）：调度时排除拥有这种标签的IP子网。
            - 必须使用（require）：调度时必须使用拥有这种标签的IP子网。
        - 举例说明：如IP子网A绑定调度标签A，默认策略为禁止使用。IP子网B绑定调度标签B，默认策略为尽量使用。调度策略A为当虚拟机属于项目A，选择调度标签A，调度标签偏好为必须使用。
            - 当创建虚拟机时网络选择默认时，有以下两种情况。
                - 当虚拟机属于项目A时，系统将选择IP子网A为虚拟机分配IP地址。
                - 当虚拟机不属于项目A时，系统将选择IP子网B为虚拟机分配IP地址。
            - 当创建虚拟机时网络选择指定IP子网A，系统将选择IP子网A为虚拟机分配IP地址。
            - 当创建虚拟机时网络选择调度标签A，且标签偏好为必须使用，则系统会从IP子网A中为虚拟机分配一个未使用的IP地址。
    - 标签：可选项，支持选择已有标签和新建标签。
        - 新建标签：单击列表上方 **_新建_** 按钮，设置标签键和标签值，单击 **_"添加"_** 按钮，新建标签并绑定到资源上。
        - 选择已有标签：单击 **_"已有标签"_** 按钮，选择标签键和值。 

    **高级设置**：默认隐藏，可根据需求进行配置。

    - 弹性公网IP：弹性公网IP是一种NAT IP，通过与虚拟机绑定，实现虚拟机与公网之间的通信。默认为暂不绑定，当选择“新建”时，需要配置以下参数：
        - 线路类型：可根据需求创建对应线路类型的EIP。
        - 网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
            - 按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。
            - 按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。
        - 带宽：设置带宽大小。
    - 公网IP（腾讯云、阿里云）：公网IP通过与虚拟机绑定，实现虚拟机与公网之间的通信。包含弹性公网IP和静态公网IP，弹性公网IP可以灵活与虚拟机绑定或解绑。静态公网IP则不支持与虚拟机解绑。默认为暂不绑定。当选择“新建弹性公网IP”或新建静态公网IP时，需要配置以下参数：
    - 网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
        - 按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。
        - 按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。
    - 带宽：设置带宽大小。
{{% alert title="注意" color="warning" %}}
- 本地IDC平台创建VPC网络的虚拟机时支持绑定弹性公网IP，且仅支持按带宽计费；
- 除腾讯云、阿里云外的公有云平台新建虚拟机时仅支持新建弹性公网IP，腾讯云和阿里云平台新建虚拟机时支持新建弹性公网IP和静态公网IP。
- 创建AWS虚拟机时，若选择的VPC不允许外网访问，则不允许新建弹性公网IP。
- 腾讯云和Azure不支持按带宽计费。
{{% /alert %}}
    - 安全组：为虚拟机设置安全组规则，安全组是一种虚拟的包过滤防火墙，通过设置安全组规则来控制关联的虚拟机是否可以被访问，以及虚拟机可访问的外部资源等。一个虚拟机最多支持绑定5个安全组。
    - 引导方式：包括BIOS和UEFI模式，仅{{<oem_name>}}平台支持。
3. 单击 **_"保存模板"_** 按钮，将创建虚拟机的配置信息保存为主机模板。

## 新建虚拟机

该功能用于基于主机模板新建虚拟机。当主机模板状态正常时才可以创建虚拟机。

1. 单击主机模板右侧操作列 **_"新建虚拟机"_** 按钮，进入新建虚拟机页面。
2. 设置名称、数量，单击 **_"确定"_** 按钮，新建虚拟机。


## 删除主机模板

该功能用于删除主机模板。当主机模板被弹性伸缩组使用时，不允许被删除。

**单个删除**

1. 在主机模板页面，单击主机模板右侧操作列 **_"删除"_** 按钮，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

**批量删除**

1. 在主机模板页面中勾选一个或多个主机模板，单击列表上方 **_"删除"_** 按钮，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

## 查看主机模板详情

该功能用于查看主机模板的详细信息。

1. 在主机模板页面，单击主机模板名称项，进入主机模板详情页面。
2. 主机模板名称右侧菜单项支持对主机模板进行的管理操作。
3. 查看以下信息。
   - 基本信息：包括云上ID、ID、名称、状态、域、项目、关联密钥、平台、计费方式、区域、可用区、云账号、创建时间、更新时间、备注。
   - 其他信息：包括操作系统、系统镜像、VPC、IP子网、安全组、系统盘、数据盘、CPU、内存、GPU、GPU数量、管理员密码。

## 查看主机模板操作日志

该功能用于查看主机模板相关操作的日志信息。

1. 在主机模板详情页面，单击“操作日志”页签，进入操作日志页面。
    - 加载更多日志：列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 **_"加载更多"_** 按钮，获取更多日志信息。
    - 查看日志详情：单击操作日志右侧操作列 **_"查看"_** 按钮，查看日志的详情信息。支持复制详情内容。
    - 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。
    - 导出日志：目前仅支持导出本页显示的日志。单击右上角![](../../../images/system/download.png)图标，在弹出的导出数据对话框中，设置导出数据列，单击 **_"确定"_** 按钮，导出日志。


