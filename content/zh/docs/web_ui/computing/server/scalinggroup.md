---
title: "弹性伸缩组"
weight: 6
description: 弹性伸缩组即根据业务需求和策略设置伸缩策略，实现虚拟机弹性扩容和收缩的功能。
---

弹性伸缩组即根据业务需求和策略设置伸缩策略，实现虚拟机弹性扩容和收缩的功能。

**入口**：在云管平台单击左上角![](../../../images/intro/nav.png)导航菜单，在弹出的左侧菜单栏中单击 **_"主机/主机/弹性伸缩组"_** 菜单项，进入弹性伸缩组页面。

![](../../../images/computing/scalinggroup.png)

## 使用流程

1. 在[主机模板](../servertemplate)页面中创建用于弹性伸缩组的主机模板，目前仅支持{{<oem_name>}}和Azure平台的主机模板。
2. 在弹性伸缩组页面创建弹性伸缩组，并选择上一步骤创建的主机模板，并设置伸缩活动的最大实例数、最小实例数以及期望实例数等。
3. 创建好的弹性伸缩组默认是启用状态，在弹性伸缩组的伸缩策略中设置伸缩策略，如定时增加或减少实例等规则、根据告警状态设置伸缩策略以及设置周期伸缩策略等。

## 弹性伸缩组管理

弹性伸缩组即通过配置主机模板等参数批量在伸缩组中基于主机模板创建相同配置的虚拟机。后续通过配置伸缩策略等实现伸缩组的自动扩容和收缩。


### 新建弹性伸缩组

该功能用于创建弹性伸缩组。

**前提条件**

- 请确保已创建了符合需求的主机模板，目前仅支持{{<oem_name>}}平台和Azure平台的主机模板。
- 弹性伸缩组如需绑定负载均衡实例，需要提前在[负载均衡实例](../../../network/lb/lb)页面创建符合条件的负载均衡实例，并配置监听和后端服务器组。目前仅{{<oem_name>}}平台的弹性伸缩组支持绑定负载均衡实例。

**操作步骤**

1. 在弹性伸缩组页面，单击列表上方 **_"新建"_** 按钮，进入新建弹性伸缩组页面。
2. 配置以下参数：
   - 指定项目：仅管理后台视图和域管理后台视图下需要选择，项目视图下指定项目即当前用户所在项目视图。
   - 名称：设置弹性伸缩组的名称。
   - 平台：目前仅支持{{<oem_name>}}和Azure平台。
   - 主机模板：主机模板即后续伸缩组中弹性扩容创建虚拟机时使用的模板。不能使用无效状态的主机模板。
   - 网络：选择伸缩组中创建的虚拟机的IP子网。
   - 最大实例数：弹性伸缩组中允许创建的最大实例数，当伸缩策略执行后期望实例数超过最大实例数时，伸缩组将会把期望实例数改成最大实例数，确保伸缩组中的实例不能超过最大实例数。
   - 最小实例数：弹性伸缩组中允许创建的最小实例数，当伸缩策略执行后期望实例数小于最小实例数时，伸缩组将会把期望实例数改成最小实例数，确保伸缩组中的实例不能低于最小实例数。
   - 期望实例数：伸缩组将会按照期望实例数的值来创建或删除虚拟机。使伸缩组中的虚拟机数量维持在期望实例数，无须人工参与。期望实例数必须小于或等于伸缩组的最大实例数，且必须大于伸缩组内的最小实例数。
   - 实例移除策略：当伸缩组收缩时，选择移除虚拟机的策略，包括优先移除最早创建的实例和优先移除最晚创建的实例等。通过伸缩策略移除的虚拟机将会直接删除，不会到回收站。
   - 负载均衡：目前仅{{<oem_name>}}平台支持绑定负载均衡实例，当绑定负载均衡实例时，需要选择负载均衡实例、后端服务器组、服务器组端口、以及权重等。
   - 健康检查方式：包括虚拟机健康检查和负载均衡健康检查。
       - 虚拟机健康检查：检查伸缩组中的虚拟机的运行状态，当发现虚拟机不处于运行中状态时，则会将虚拟机移除并删除，并创建新的虚拟机。
       - 负载均衡健康检查：仅绑定负载均衡的伸缩组支持设置该项，通过负载均衡健康检查后端服务器组中的虚拟机是否可以正常转发流量，当无法正常转发流量时，则会将虚拟机移除并删除，并创建新的虚拟机。
   - 检查周期：设置伸缩组进行健康检查的周期。
   - 健康状态检查宽限期：当伸缩组中的虚拟机创建成功后，将不会立即检查虚拟机的健康状态，而是等到宽限期后才会开始进行健康检查。
3. 单击 **_"确定"_** 按钮，创建弹性伸缩组。 

### 启用

该功能用于启用"禁用"状态的伸缩组。只有伸缩组处于启用状态时，伸缩组中的伸缩策略才会生效。

**单个启用**

1. 在弹性伸缩组页面，单击"禁用"状态的弹性伸缩组右侧操作列 **_"启用"_** 按钮，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，启用弹性伸缩组。

**批量启用**

1. 在弹性伸缩组页面中勾选一个或多个"禁用"状态的弹性伸缩组，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"启用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，批量启用弹性伸缩组。

### 禁用

该功能用于禁用"启用"状态的伸缩组。禁用状态下的伸缩组中的所有伸缩策略都不生效无法执行，但是仍可创建伸缩策略。

**单个禁用**

1. 在弹性伸缩组页面，单击"启用"状态的弹性伸缩组右侧操作列 **_"禁用"_** 按钮，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，禁用弹性伸缩组。

**批量禁用**

1. 在弹性伸缩组页面中勾选一个或多个"启用"状态的弹性伸缩组，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"禁用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，批量禁用弹性伸缩组。

### 删除弹性伸缩组

当弹性伸缩组下没有虚拟机且处于禁用状态时，才可以删除弹性伸缩组。

**删除单个弹性伸缩组**

1. 在弹性伸缩组页面，单击弹性伸缩组右侧操作列 **_"删除"_** 按钮，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

**批量删除弹性伸缩组**

1. 在弹性伸缩组页面中勾选一个或多个弹性伸缩组，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹性操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

## 查看弹性伸缩组详情

该功能用于查看弹性伸缩组的详细信息。

1. 在弹性伸缩组页面，单击伸缩组名称项，进入弹性伸缩组详情页面。
2. 详情页面顶部菜单项支持对弹性伸缩组进行管理操作等。
3. 查看以下信息：
   - 基本信息：包括弹性伸缩组的云上ID、ID、名称、状态、域、项目、启用状态、平台、伸缩策略数、创建时间、更新时间、备注等。
   - 伸缩组信息：包括弹性伸缩组的主机模板、当前实例数、期望实例数、最小实例数、最大实例数、移除策略、VPC、负载均衡、健康检查方式、检查周期、健康状态检查宽限期等。

## 伸缩策略管理

**入口**：在弹性伸缩组页面，单击伸缩组名称项，在进入弹性伸缩组详情页面中单击顶部“伸缩策略”页签，进入伸缩策略页面。

### 新建伸缩策略

该功能用于为弹性伸缩组设置伸缩策略，伸缩组将按照伸缩策略自动扩容或收缩。

1. 在伸缩策略页面，单击列表上方 **_"新建"_** 按钮，弹出新建对话框。
2. 设置以下参数。
   - 名称：伸缩策略的名称。
   - 策略类型：包括告警策略、定时策略和周期策略。
       - 告警策略：根据伸缩组中的虚拟机资源使用率等条件来设置伸缩策略。
       - 定时策略：在指定的时间对伸缩组进行扩容或收缩操作。
       - 周期策略：在指定的周期内对伸缩组进行扩容或收缩操作。
   - 当选择策略类型为“告警策略”时，需要配置以下参数：
       - 触发条件：根据需求选择告警指标，包括CPU平均利用率、平均网络入流量、平均网络出流量、平均磁盘写速率、平均磁盘读速率；并设置告警指标大于、小于设定的目标值时执行伸缩活动。
       - 连续出现次数：当上面的触发条件连续出现设定的次数时才会进行伸缩活动。
       - 执行动作：当满足触发条件时，伸缩组需要执行的动作，包括增加N个实例、减少N个实例、或将实例数调整为N（其中调整实例数N需要大于等于最小值且小于等于最大值）。
       - 默认冷却时间：当该伸缩活动执行完成后，即使伸缩组存在的任意告警策略满足触发条件，在设置的冷却时间内将不会执行伸缩动作。
   - 当选择策略类型为“定时策略”时，需要配置以下参数：
       - 触发时间：选择具体的日期和时间，当到达触发时间后，将会执行伸缩活动。
       - 执行动作：当满足触发条件时，伸缩组需要执行的动作，包括增加N个实例、减少N个实例、或将实例数调整为N（其中调整实例数N需要大于等于最小值且小于等于最大值）。
       - 默认冷却时间：当该伸缩活动执行完成后，即使伸缩组存在的任意告警策略满足触发条件，在设置的冷却时间内将不会执行伸缩动作。
   - 当选择策略类型为“周期策略”时，需要配置以下参数：
       - 重复周期：设置执行的周期，包括每天、每周、每月。
       - 触发日期（星期）：当选择每周时，需要设置触发的星期；当选择每月时，需要选择触发的日期。
       - 触发时间：具体执行策略的时间点。
       - 有效时间：设置周期策略的开始日期和结束日期，仅在有效时间内执行伸缩策略。
       - 执行动作：当满足触发条件时，伸缩组需要执行的动作，包括增加N个实例、减少N个实例、或将实例数调整为N（其中调整实例数N需要大于等于最小值且小于等于最大值）。
       - 默认冷却时间：当该伸缩活动执行完成后，即使伸缩组存在的任意告警策略满足触发条件，在设置的冷却时间内将不会执行伸缩动作。
3. 单击 **_"确定"_** 按钮，创建伸缩策略。


### 立即执行伸缩策略

该功能用于立即执行伸缩策略，而不用等到触发条件生效。立即执行后，伸缩组的期望实例数将会按照策略设置的执行动作进行更改。只有"启用"状态的伸缩策略可以立即执行。

1. 在伸缩策略页面，单击"启用"状态的伸缩策略右侧操作列 **_"立即执行"_** 按钮，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，立即执行策略，按照策略的执行动作更改期望实例数。

### 启用

该功能用于启用伸缩策略，只有伸缩策略处于启用状态才可以被执行或触发。

**单个启用**

1. 在伸缩策略页面，单击"禁用"状态的伸缩策略右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"启用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，启用伸缩策略。

**批量启用**

1. 在伸缩策略页面中勾选一个或多个"禁用"状态的伸缩策略，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"启用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，启用伸缩策略。

### 禁用

该功能用于禁用伸缩策略，禁用状态的伸缩策略无法被执行。

**单个禁用**

1. 在伸缩策略页面，单击"启用"状态的伸缩策略右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"禁用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，禁用伸缩策略。

**批量禁用**

1. 在伸缩策略页面中勾选一个或多个"启用"状态的伸缩策略，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"禁用"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，禁用伸缩策略。


### 删除伸缩策略

该功能用于删除伸缩策略，在删除伸缩策略之前，请先禁用伸缩策略。

**删除单个伸缩策略**

1. 在伸缩策略页面，单击"禁用"状态的伸缩策略右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

**批量删除伸缩策略**

1. 在伸缩策略页面中勾选一个或多个"禁用"状态的伸缩策略，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

## 活动历史

当伸缩组执行伸缩策略或手动移除实例时，均会更改伸缩组中的期望实例数，实现扩张或收缩。活动历史将会记录伸缩组的扩张和收缩的活动。

**入口**：在弹性伸缩组页面，单击伸缩组名称项，在进入弹性伸缩组详情页面中单击顶部“活动历史”页签，进入活动历史页面。

### 伸缩活动状态

伸缩活动状态 | 说明 | 举例
---------|----------|---------
 拒绝 | 伸缩操作在请求阶段被拒绝，未执行扩张或收缩操作 | 场景：</br> - 伸缩组最大实例数是100；</br>- 伸缩组中当前实例数为100；<br>- 伸缩策略要求自动创建10台虚拟机；<br> 结果：</br> 伸缩操作未通过条件检验，被拒绝执行。伸缩活动结束后，伸缩组中当前实例数仍为100。
 部分成功 |伸缩活动执行完成后，至少有一台虚拟机加入或移出伸缩组，且至少有一台虚拟机未能成功加入或移出伸缩组  | 场景：</br> - 伸缩组最大实例数是100；</br>- 伸缩组中当前实例数为95；<br>- 伸缩策略要求自动创建10台虚拟机；<br> 结果：</br> 伸缩操作仅创建了5台虚拟机加入了伸缩组，其它5台虚拟机未能成功创建。伸缩活动结束后，伸缩组中的当前实例为100。
 成功 | 伸缩活动完成后，伸缩策略要求的虚拟机都加入或移出了伸缩组  | 场景：</br> - 伸缩组最大实例数是100；</br>- 伸缩组中当前实例数为90；<br>- 伸缩策略要求自动创建10台虚拟机；<br> 结果：</br> 伸缩操作创建了10台虚拟机加入伸缩组。伸缩活动结束后，伸缩组中的当前实例为100。
 失败 | 伸缩活动结束后，伸缩策略要求的虚拟机都没有加入或移出伸缩组 | 场景：</br>- 伸缩组申请的资源不足</br> - 伸缩组最大实例数是100；</br>- 伸缩组中当前实例数为90；<br>- 伸缩策略要求自动创建10台虚拟机；<br> 结果：</br> 伸缩操作通过了条件检验，但由于资源不足导致创建失败。伸缩活动结束后，伸缩组中的当前实例仍为90。

### 查看活动历史详情

该功能用于查看伸缩活动的详细信息，了解伸缩策略触发的伸缩动作产生的结果。

1. 在活动历史页面，支持查看伸缩活动的ID、状态、起因描述、行为描述、开始时间、结束时间等。
2. 单击活动历史右侧操作列 **_"查看"_** 按钮，查看失败或部分成功、拒绝状态的伸缩活动的详细信息。


## 当前实例

该功能用于查看伸缩组中当前存在的实例信息，支持移除当前实例。

**入口**：在弹性伸缩组页面，单击伸缩组名称项，在进入弹性伸缩组详情页面中单击顶部“当前实例”页签，进入当前实例页面。

### 查看当前实例

1. 在当前实例页面，支持查看虚拟机的名称、IP、系统、密码、状态、配置、创建时间、宿主机、云账号等信息。

### 移除当前实例

该功能用于将虚拟机移除伸缩组，移除虚拟机将会修改期望实例数，比如移除一个虚拟机，期望实例数将减一。

**移除单个虚拟机**

1. 在当前实例页面，单击虚拟机右侧操作列 **_"移除"_** 按钮，弹出移除对话框。
2. 设置移除方式。
   - 移除并删除：将虚拟机移除伸缩组并彻底删除。
   - 仅移除：仅将虚拟机移除伸缩组，移除的虚拟机还会显示在虚拟机列表。
3. 单击 **_"确定"_** 按钮，根据移除方式执行操作。

**批量移除**

1. 在当前实例列表中选择一个或多个实例，单击列表上方 **_"移除"_** 按钮，弹出移除对话框。
2. 设置移除方式。
   - 移除并删除：将虚拟机移除伸缩组并彻底删除。
   - 仅移除：仅将虚拟机移除伸缩组，移除的虚拟机还会显示在虚拟机列表。
3. 单击 **_"确定"_** 按钮，根据移除方式执行操作。

## 主机模板

该功能仅用于查看伸缩组选择的主机模板信息。

1. 在弹性伸缩组页面，单击伸缩组名称项，在进入弹性伸缩组详情页面中单击顶部“主机模板”页签，进入主机模板页面。
2. 在主机模板页面，支持查看主机模板的名称、配置、系统、系统镜像、计费方式、状态、VPC、项目、平台等信息。

## 查看操作日志

该功能用于查看伸缩组中相关操作的日志信息。

1. 在弹性伸缩组页面，单击伸缩组名称项，在进入弹性伸缩组详情页面中单击顶部“操作日志”页签，进入操作日志页面。
    - 加载更多日志：列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 **_"加载更多"_** 按钮，获取更多日志信息。
    - 查看日志详情：单击操作日志右侧操作列 **_"查看"_** 按钮，查看日志的详情信息。支持复制详情内容。
    - 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。
    - 导出日志：目前仅支持导出本页显示的日志。单击右上角![](../../../images/system/download.png)图标，在弹出的导出数据对话框中，设置导出数据列，单击 **_"确定"_** 按钮，导出日志。



